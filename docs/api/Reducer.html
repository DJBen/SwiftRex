<!DOCTYPE html>
<html lang="en">
  <head>
    <title>Reducer  Reference</title>
    <link rel="stylesheet" type="text/css" href="css/jazzy.css" />
    <link rel="stylesheet" type="text/css" href="css/highlight.css" />
    <meta charset='utf-8'>
    <script src="js/jquery.min.js" defer></script>
    <script src="js/jazzy.js" defer></script>
    
  </head>
  <body>
    <a name="//apple_ref/swift/Section/Reducer" class="dashAnchor"></a>
    <a title="Reducer  Reference"></a>
    <header>
      <div class="content-wrapper">
        <p><a href="index.html">SwiftRex Docs</a> (91% documented)</p>
        <p class="header-right"><a href="https://github.com/SwiftRex/SwiftRex"><img src="img/gh.png"/>View on GitHub</a></p>
      </div>
    </header>
    <div class="content-wrapper">
      <p id="breadcrumbs">
        <a href="index.html">SwiftRex Reference</a>
        <img id="carat" src="img/carat.png" />
        Reducer  Reference
      </p>
    </div>
    <div class="content-wrapper">
      <nav class="sidebar">
        <ul class="nav-groups">
          <li class="nav-group-name">
            <a href="Store (contracts).html">Store (contracts)</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a href="Store (contracts).html#/s:8SwiftRex5StoreP">Store</a>
              </li>
              <li class="nav-group-task">
                <a href="Store (contracts).html#/s:8SwiftRex13EventProtocolP">EventProtocol</a>
              </li>
              <li class="nav-group-task">
                <a href="Protocols/EventHandler.html">EventHandler</a>
              </li>
              <li class="nav-group-task">
                <a href="Protocols/StateProvider.html">StateProvider</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a href="Store (basic implementation).html">Store (basic implementation)</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a href="Classes/StoreBase.html">StoreBase</a>
              </li>
              <li class="nav-group-task">
                <a href="Protocols/ActionHandler.html">ActionHandler</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a href="Reducer.html">Reducer</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a href="Structs/Reducer.html">Reducer</a>
              </li>
              <li class="nav-group-task">
                <a href="Reducer.html#/s:8SwiftRex14ActionProtocolP">ActionProtocol</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a href="Middleware (basics).html">Middleware (basics)</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a href="Protocols/Middleware.html">Middleware</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/BypassMiddleware.html">BypassMiddleware</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/DirectLineMiddleware.html">DirectLineMiddleware</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/ComposedMiddleware.html">ComposedMiddleware</a>
              </li>
              <li class="nav-group-task">
                <a href="Middleware (basics).html#/s:8SwiftRex2lgoiyAA18ComposedMiddlewareCy9StateTypeQzGx_q_tAA0E0RzAaHR_AEQy_AFRSr0_lF">&lt;&gt;(_:_:)</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/SubstateMiddleware.html">SubstateMiddleware</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/AnyMiddleware.html">AnyMiddleware</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a href="Side-Effects.html">Side-Effects</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a href="Protocols/SideEffectMiddleware.html">SideEffectMiddleware</a>
              </li>
              <li class="nav-group-task">
                <a href="Protocols/SideEffectProducer.html">SideEffectProducer</a>
              </li>
              <li class="nav-group-task">
                <a href="Structs/SideEffectError.html">SideEffectError</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/AnySideEffectProducer.html">AnySideEffectProducer</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a href="Composition helpers.html">Composition helpers</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a href="Protocols/Monoid.html">Monoid</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a href="Closure type-aliases.html">Closure type-aliases</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a href="Closure type-aliases.html#/EventEvaluation">EventEvaluation</a>
              </li>
              <li class="nav-group-task">
                <a href="Closure type-aliases.html#/s:8SwiftRex8GetStatea">GetState</a>
              </li>
              <li class="nav-group-task">
                <a href="Closure type-aliases.html#/s:8SwiftRex17NextActionHandlera">NextActionHandler</a>
              </li>
              <li class="nav-group-task">
                <a href="Closure type-aliases.html#/s:8SwiftRex16NextEventHandlera">NextEventHandler</a>
              </li>
              <li class="nav-group-task">
                <a href="Closure type-aliases.html#/s:8SwiftRex14ReduceFunctiona">ReduceFunction</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a href="Other Typealiases.html">Other Type Aliases</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a href="Other Typealiases.html#/FailableObservableSignal">FailableObservableSignal</a>
              </li>
              <li class="nav-group-task">
                <a href="Other Typealiases.html#/FailableObservableSignalProducer">FailableObservableSignalProducer</a>
              </li>
              <li class="nav-group-task">
                <a href="Other Typealiases.html#/ObservableProperty">ObservableProperty</a>
              </li>
              <li class="nav-group-task">
                <a href="Other Typealiases.html#/ObservableSignal">ObservableSignal</a>
              </li>
              <li class="nav-group-task">
                <a href="Other Typealiases.html#/ObservableSignalProducer">ObservableSignalProducer</a>
              </li>
              <li class="nav-group-task">
                <a href="Other Typealiases.html#/ReactiveProperty">ReactiveProperty</a>
              </li>
              <li class="nav-group-task">
                <a href="Other Typealiases.html#/SubscriptionOwner">SubscriptionOwner</a>
              </li>
            </ul>
          </li>
        </ul>
      </nav>
      <article class="main-content">
        <section>
          <section class="section">
            <h1>Reducer</h1>
            
          </section>
          <section class="section task-group-section">
            <div class="task-group">
              <ul>
                <li class="item">
                  <div>
                    <code>
                    <a name="/s:8SwiftRex7ReducerV"></a>
                    <a name="//apple_ref/swift/Struct/Reducer" class="dashAnchor"></a>
                    <a class="token" href="#/s:8SwiftRex7ReducerV">Reducer</a>
                    </code>
                  </div>
                  <div class="height-container">
                    <div class="pointer-container"></div>
                    <section class="section">
                      <div class="pointer"></div>
                      <div class="abstract">
                        <p>⚙ <code>Reducer</code> is a pure function wrapped in a monoid container, that takes current state and an action to calculate the new state.</p>

<p>The <code><a href="Protocols/Middleware.html">Middleware</a></code> pipeline can trigger <code><a href="Reducer.html#/s:8SwiftRex14ActionProtocolP">ActionProtocol</a></code>, and handles both <code><a href="Store (contracts).html#/s:8SwiftRex13EventProtocolP">EventProtocol</a></code> and <code><a href="Reducer.html#/s:8SwiftRex14ActionProtocolP">ActionProtocol</a></code>. But what they can NOT do is changing the app state. Middlewares have read-only access to the up-to-date state of our apps, but when mutations are required we use the <code>Reducer</code> function. Actually, it&rsquo;s a protocol that requires only one method:</p>
<pre class="highlight swift"><code><span class="kd">func</span> <span class="nf">reduce</span><span class="p">(</span><span class="n">_</span> <span class="nv">currentState</span><span class="p">:</span> <span class="kt">StateType</span><span class="p">,</span> <span class="nv">action</span><span class="p">:</span> <span class="kt">Action</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">StateType</span>
</code></pre>

<p>Given the current state and an action, returns the calculated state. This function will be executed in the last stage of an action handling, when all middlewares had the chance to modify or improve the action. Because a reduce function is composable monoid and also can be lifted through lenses, it&rsquo;s possible to write fine-grained <q>sub-reducer</q> that will handle only a <q>sub-state</q>, creating a pipeline of reducers.</p>

<p>It&rsquo;s important to understand that reducer is a synchronous operations that calculates a new state without any kind of side-effect, so never add properties to the <code>Reducer</code> structs or call any external function. If you are tempted to do that, please create a middleware. Reducers are also responsible for keeping the consistency of a state, so it&rsquo;s always good to do a final sanity check before changing the state.</p>

<p>Once the reducer function executes, the store will update its single source of truth with the new calculated state, and propagate it to all its observers.</p>

                        <a href="Structs/Reducer.html" class="slightly-smaller">See more</a>
                      </div>
                      <div class="declaration">
                        <h4>Declaration</h4>
                        <div class="language">
                          <p class="aside-title">Swift</p>
                          <pre class="highlight swift"><code><span class="kd">public</span> <span class="kd">struct</span> <span class="kt">Reducer</span><span class="o">&lt;</span><span class="kt">StateType</span><span class="o">&gt;</span></code></pre>

                        </div>
                      </div>
                    </section>
                  </div>
                </li>
              </ul>
            </div>
            <div class="task-group">
              <ul>
                <li class="item">
                  <div>
                    <code>
                    <a name="/s:8SwiftRex14ActionProtocolP"></a>
                    <a name="//apple_ref/swift/Protocol/ActionProtocol" class="dashAnchor"></a>
                    <a class="token" href="#/s:8SwiftRex14ActionProtocolP">ActionProtocol</a>
                    </code>
                  </div>
                  <div class="height-container">
                    <div class="pointer-container"></div>
                    <section class="section">
                      <div class="pointer"></div>
                      <div class="abstract">
                        <p>🏄‍ <code>ActionProtocol</code> represents an action, usually created by a <code><a href="Protocols/Middleware.html">Middleware</a></code> in response to an event.</p>

<p>Like events, <code>ActionProtocol</code> is also a marker protocol which concrete implementation is a value-type structure holding the associated value that is necessary to request a change in the state. Differently from events, although, actions have more meaningful values and are driven by business logic. While an <code><a href="Store (contracts).html#/s:8SwiftRex13EventProtocolP">EventProtocol</a></code> represents taps in the interface and usually has associated values like <code>3</code> or <code>true</code>, an <code>ActionProtocol</code> is expected to hold the information required to mutate the state, such as: <q>got a new list of movies</q> with an associated values of <code>[Movie]</code>, or <q>delete invoice</q> and the associated value being the Invoice object. That way, we should not expect actions to be triggered by an <code>UIViewController</code>, only by a <code><a href="Protocols/Middleware.html">Middleware</a></code> running in the <code><a href="Store (contracts).html#/s:8SwiftRex5StoreP">Store</a></code>. Some middlewares can create one or multiple actions out of an event, collecting the proper state information from the indexes passed with the event, and then finally composing a very meaningful action that contains exactly the metadata for the change.</p>

<p>An event may end up not changing the state, but an action necessarily implies that the state will be mutated accordingly; for example the event <code>viewDidLoad</code> may not change your state, having the only purpose of logging or tracking analytics events (let&rsquo;s talk about side-effects later), and in that case don&rsquo;t change anything in the app; while an action <code>userHasLoggedIn</code> will necessarily change something on the state.</p>
<pre class="highlight swift"><code><span class="kd">enum</span> <span class="kt">MovieListAction</span><span class="p">:</span> <span class="kt">ActionProtocol</span> <span class="p">{</span>
    <span class="k">case</span> <span class="nf">setMovieAsWatched</span><span class="p">(</span><span class="nv">movieId</span><span class="p">:</span> <span class="kt">UUID</span><span class="p">)</span>
    <span class="k">case</span> <span class="nf">setMovieAsUnwatched</span><span class="p">(</span><span class="nv">movieId</span><span class="p">:</span> <span class="kt">UUID</span><span class="p">)</span>
    <span class="k">case</span> <span class="nf">setCurrentMovieDetailsPage</span><span class="p">(</span><span class="nv">movie</span><span class="p">:</span> <span class="kt">Movie</span><span class="p">)</span>
    <span class="k">case</span> <span class="nf">setMoviesAsWatched</span><span class="p">(</span><span class="nv">movies</span><span class="p">:</span> <span class="p">[</span><span class="kt">Movie</span><span class="p">])</span>
<span class="p">}</span>
</code></pre>

                      </div>
                      <div class="declaration">
                        <h4>Declaration</h4>
                        <div class="language">
                          <p class="aside-title">Swift</p>
                          <pre class="highlight swift"><code><span class="kd">public</span> <span class="kd">protocol</span> <span class="kt">ActionProtocol</span></code></pre>

                        </div>
                      </div>
                    </section>
                  </div>
                </li>
              </ul>
            </div>
          </section>
        </section>
        <section id="footer">
          <p>&copy; 2019 <a class="link" href="https://github.com/SwiftRex/SwiftRex" target="_blank" rel="external">SwiftRex</a>. All rights reserved. (Last updated: 2019-03-18)</p>
          <p>Generated by <a class="link" href="https://github.com/realm/jazzy" target="_blank" rel="external">jazzy ♪♫ v0.9.4</a>, a <a class="link" href="https://realm.io" target="_blank" rel="external">Realm</a> project.</p>
        </section>
      </article>
    </div>
  </body>
</div>
</html>
